---
title: 'gtags (GNU global) in emacs for Scala'
date: 2019-05-09T17:27:00.000+02:00
draft: false
tags : [emacs, Scala, spacemacs]
dropcap: true
featured_image: "thom-masat-694057-unsplash.jpg"
---

As you may know, I’m a heavy [emacs](https://www.mostlymaths.net/search/label/emacs) user, and a frequent Scala developer. Scala tooling for emacs was restricted to mostly ensime until recently. Although ensime is an excellent piece of software, it made my old Macbook suffer a lot (it only had 8gb of RAM). So, most of the time I just went hardcore mode developer, and worked with no autocompletion, no jump to definition, no-nothing. A pervasive use of ripgrep and good memory were sometimes enough, but I was envious of many things I could see in my colleagues using IntelliJ. Of course, switching editors was not an option.

<!--more-->

{{< figure src="thom-masat-694057-unsplash.jpg" class="fig-wide" caption="Photo by [thom masat](https://unsplash.com/photos/8kLFdQh6scA?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)">}}

I looked up what solutions were available, and the only option that seemed good enough was using the classic `ctags/etags/gtags` I hadn’t used since my C days.

Having a tags implementation can bring an almost-decent jump-to-definition essentially for free: gtags (and the others) work by pre-analysing the data and generating symbol maps which are usually stored as files, the overhead in speed and memory is minimal.

Installing it can get somewhat unintuitive (specially on Mac), since you need _very_ specific settings for it to work with emacs and especially, Scala code.

Start by installing [GNU global](https://en.m.wikipedia.org/wiki/GNU_GLOBAL):
```bash
brew install global --with-pygments --with-ctags --with-exuberant-ctags
```
The key parts is having `pygments`.
Aside from this you will need to export the following environment variables:

```bash
GTAGSCONF=/usr/local/share/gtags/gtags.conf
GTAGSLABEL=pygments
```

Finally, you need to install (or activate) `ggtags-mode`. If you use spacemacs, you only need to activate the `gtags` layer.
All this has become moot as soon as [metals](https://scalameta.org/metals/) has reached a usable state: now you can have a really fast language server for Scala, written in Scala with low memory overhead.
